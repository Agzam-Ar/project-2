# Плавающая точка

Плавающая точка — это формат для представления чисел, который сочетает целую и дробную части с помощью мантиссы и экспоненты.

В системах счисления с основанием $k$, вещественное число $x$ представляется в формате с плавающей точкой следующим образом: 

$$
x=m_x \cdot k^{Px}
$$

$m_x$ - мантисса числа $x$
$p_x$ - порядок числа $x$

При этом мантисса $m_x$ обязательно нормализуется. 

## **Правила нормализации**

Нормализация числа происходит по следующим правилам:
$$
x=m_x \cdot k^{Px}
$$
Умножение на $k^{Px}$ приводит к переносу точки в $m_x$
  - влево, если $p_x$ < 0
  - вправо, если $p_x$ > 0
Порядок числа $p_x$ подбирается так, чтобы мантисса была нормализованной.

## **Для вида нормализации**  

|                     | Стандартная           | Дробная                |
|---------------------|-----------------------|------------------------|
|$m_x \cdot k^{Px}$   | $ 1 \leq m_x < k $    | $k^{-1} \leq m_x < 1$  | 
| $14.625$            | $1.4625 \cdot 10^{1}$ | $0.14625 \cdot 10^{2}$ |
| $0.0625$            | $6.25 \cdot 10^{-2}$  | $0.625 \cdot 10^{-1}$ |

В большинстве реальных задач используется стандартная нормализация:
- $N_A = 6.02214129 \cdot 10^{23} \text{ моль}^{-1}$
- $M_\oplus = 5.9722 \cdot 10^{24} \text{ кг}$

---
## Порядок

### Описание формата для примера  
Описание формата:
- Мантисса и порядок в прямом коде
- Знак мантиссы: 15-й разряд
- Знак порядка: 5-й разряд

#### Пример 
**Число** 
$-78.4453125$ = $-1001110.0111001_2$

**Нормализированное представление** 
$-0.10011100111001_2 \cdot 2^{111_2}$  

**Результат** 

$\texttt{[1|00111001|0|00111]}$  

***

## **Характеристика** 
Характеристика $c_x$ - смещённый порядок, всегда положительное число: 
$$
c_x = p_x + \Delta
$$  
$p_x$ - исходный порядок числа
$\Delta = 2^{n-1}$ - смещение (n - число разрядов под порядок)

### Формула числа  
$$
x = m_x \cdot k^{(c_x - \Delta)}
$$ 
**При использовании дополнительного кода:**

$[-2^{n-1}, 2^{n-1}-1]$ 

**Смещение подбирается так, чтобы:**
$-2^{n-1} + \Delta = 0 \quad \Rightarrow \quad \Delta = 2^{n-1}$
### **Пример**
**Число** 
$-78.4453125$ 
**Нормализация**

$-78.4453125$ = $(-0.10011100111001_2 \cdot 2^{111_2}$

**Результат**

$\texttt{[1|10011100|100111]}$ 
   
---
## **Форматы на практике**

### Форматы применяемые на практике: *ЕС ЭВМ*  
Формула:  
$$
x = m_x \cdot 16^{(c_x - \Delta)}
$$  
Параметры:  
- 32/64/128 бит  
- 7 бит характеристики ($\Delta = 64$)  
- 16-ричная мантисса (4 бита → 1 цифра)  

### Примеры:  
1. Число $-78.4453125$:  
   - Двоичное: $-1001110.0111001_2$  
   - Формат: $\texttt{[1|1000010|0100 1110 0111 0010 0000 0000]}$ 

2. Число $0.00537109375$:  
   - Двоичное: $0.00000001011_2$  
   - Формат: $\texttt{[0|0111111|0001 0110 0000 0000 0000 0000]}$ 

### Форматы применяемые на практике: *СМ ЭВМ (ПЭВМ)*  
Формула:  
$$
x = m_x \cdot 2^{(c_x - 128)}
$$
Параметры:  
- 32/64 бит  
- 8 бит характеристики ($\Delta = 128$)  
- Двоичная мантисса  

#### Примеры:  
**Число:** $-78.4453125_{10}$

**Формат:** $\texttt{[1|10000111|10011100111001000000000]}$ 

**Число:** $0.00537109375_{10}$  

**Формат:** $\texttt{[0|01111|10110000000000000000000]}$ 

---
## **Оценка погрешности**
> Абсолютная погрешность зависит от порядка: чем он больше, тем больше и погрешность представления чисел.
> $\Delta$ = $\tfrac {2^({p_x}-||m_x||)}{2}$
> Относительная погрешность $\delta$ - практически константа и равна *(в худшем случае)* вкладу младшего разряда мантиссы.
> $\delta$ = $2^{-||m_x||}$

$$
x=m_x \cdot 2^{px}
$$
Абсолютная погрешность зависит от порядка числа:
$$
\Delta = \tfrac {2^-||m_x||}{2} \cdot 2^{p_x} = \tfrac{2^({p_x}-|m_x|)}{2}
$$
Для относительной погрешности:
$$
\delta = \tfrac {\Delta}{|x|}
$$  
Оценим диапазон, который, как видно, от порядка числа не зависит:
$$
\delta_{max} = \tfrac {\Delta}{2^{-1} \cdot 2^{p_x}} = 2^{-||m_x||}
$$
$$
\delta_{min} = \tfrac {\Delta}{(1-2^{-||m_x||)} \cdot 2^{P_x}} = \tfrac{2^{-\|m_x\|}}{2\cdot(1-2^{-\|m_x\|})} \approx \tfrac {2^{-||m_x||}}{2}
$$

--- 
## Проверь себя

### Что представляет собой число в формате с плавающей точкой?

```quiz
- Только целую часть
- Только дробную часть
+ Мантиссу и порядок 
- Только знак числа  
```

---

### Как выглядит стандартная нормализация мантиссы в системе с основанием $k$?  
```quiz
- 0 ≤ mₓ < 1
+ 1 ≤ mₓ < k   
- k ≤ mₓ < 2k 
- mₓ = 0  
```

---

### Как вычисляется характеристика $cₓ$ в формате плавающей точки?  
```quiz
- cₓ = pₓ - Δ  
- cₓ = pₓ · Δ
+ cₓ = pₓ + Δ    
- cₓ = pₓ / Δ   
```

---
### Что произойдёт, если порядок отрицательный?  
```quiz
- Точка в мантиссе сдвинется вправо     
+ Точка в мантиссе сдвинется влево   
- Мантисса не изменится  
- Число станет нулём
```

---
### Какое смещение $Δ$ используется для 8-битной характеристики
```quiz
- 64
+ 128 
- 256    
- 32   
```

---
### Что верно для относительной погрешности  
```quiz
- Зависит от порядка  
+ Практически постоянна 
- Равна абсолютной погрешности    
- Уменьшается с ростом порядка 
```

---

